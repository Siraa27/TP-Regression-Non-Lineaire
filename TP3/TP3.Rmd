---
title: "TP3"
author: "Israa BEN SASSI"
date: "9/27/2021"
output: html_document
---


# Partie 1 

## Question 2
 Simulation de 2000 réalisationd'une varaible aléatoire Z
```{r}
n = 2000
u = runif(n)
x = rnorm(n)
Z = (u < 3/5) * (x-1) + (u> 3/5) * (x+2)

```

```{r}
f = function(x){
         f = 3 * dnorm(x,-1,1) / 5 + 2 * dnorm(x,2,1) / 5
}

```

```{r}
t= seq(from = -5, to = 6, by = 0.1)
```


## Les valeurs estimer par Rozenblatt
```{r}

par(mfrow = c(2,2))
S = c(50,100,500,2000)
for (n in S){
  plot(t,f(t), type = "l",main= n)
  est1 = density(Z[1:n],kernel="rectangular",n=length(t), from=-5, to=6)
  est2 = density(Z[1:n],kernel="gaussian",n=length(t), from=-5, to=6)
  lines(est1, col = "cyan")
  lines(est2, col = "red")
  legend("topright", ,legend=c("Densite","est1","est2"),col=c("black","red","cyan"),lty=1)
}

par(new = TRUE)
```

```{r}
n1 = 500
u1 = runif(n)
x1 = rnorm(n)
Z1 = (u1 < 3/5) * (x1-1) + (u1> 3/5) * (x1+2)
f = function(x1){
         f = 3 * dnorm(x1,-1,1) / 5 + 2 * dnorm(x1,2,1) / 5
}

k = seq(from = -5, to = 6, by = 0.1)

sZ = sd(Z)
alpha = c(0.1,0.2,0.3,0.5,0.7,0.8)


par(mfrow = c(2,2))

S1 = c(50,100,200,500)


for(a in alpha){
  fenetre = sZ*n1**(-a)
  for (n in S1){
  plot(k,f(k), type = "l", main= a, sub=n)
  PR= density(Z1[1:n],kernel="gaussian", bw = fenetre )
  lines(PR, col = "cyan")
  legend("topright", ,legend=c("Densite","PR"),col=c("black","cyan"),lty=1)
  }
}
par(new = TRUE)

```



Partie 2 :
```{r}
nomfile = "http://lmi2.insa-rouen.fr/~bportier/Data/donpol.txt"
pollution <- read.table(file=nomfile,header=T,dec=".")
par(mfrow=c(1,3))


alpha = 0.2 
p = data.frame(pollution$ozon, pollution$temp, pollution$vent) 
names = c("Ozon","Temp", "Vent")
color = c("red","green","black")
kernel = c("gaussian", "epanechnikov", "rectangular","triangular", "biweight", "cosine", "optcosine")
ecart = NULL
fenetre = NULL
for (k in kernel){
for (i in 1:ncol(p)){
  hist(p[,i],prob=T,nclass=20,main= names[i],col="cyan")
  ecart[i] = sd(p[,i])
  fenetre[i] =  ecart[i]*nrow(p[i])**(-alpha)
  print(k)
  est = density(p[,i], bw = fenetre[i], kernel = k)
  lines(est, col= color[i],  lwd=2.5)
  legend("topright", ,legend=names,col=color,lty=1)
  }

}
```


Tirer des conclusions sur les distributions
```{r}
nomfile = "http://lmi2.insa-rouen.fr/~bportier/Data/donpol.txt"
pollution <- read.table(file=nomfile,header=T,dec=".")
par(mfrow=c(1,3))
hist(pollution$ozon,prob=T,nclass=20,main="Ozon",col="cyan")
hist(pollution$temp,prob=T,nclass=20,main="Temp",col="cyan")
hist(pollution$vent,prob=T,nclass=20,main="Vent",col="cyan")
par(new = TRUE)
```


