---
title: "TP3"
author: "Israa BEN SASSI"
date: "9/27/2021"
output: html_document
---


# Partie 1 

## Question 2
 Simulation de 2000 réalisationd'une varaible aléatoire Z
```{r}
n = 2000
u = runif(n)
x = rnorm(n)
Z = (u < 3/5) * (x-1) + (u> 3/5) * (x+2)

```

```{r}
f = function(x){
         f = 3 * dnorm(x,-1,1) / 5 + 2 * dnorm(x,2,1) / 5
}

```

```{r}
t= seq(from = -5, to = 6, by = 0.1)
```


## Les valeurs estimer par Rozenblatt
```{r}

par(mfrow = c(2,2))
n = c(50,100,500,2000)
for (i in n){
  plot(t,f(t), type = "l",main= i)
  est1 = density(Z[1:i],kernel="rectangular",n=length(t), from=-5, to=6)
  est2 = density(Z[1:i],kernel="gaussian",n=length(t), from=-5, to=6)
  lines(est1, col = "cyan")
  lines(est2, col = "red")
  legend("topright", ,legend=c("Densite","est1","est2"),col=c("black","red","cyan"),lty=1)
}

par(new = TRUE)
```

```{r}
n1 = 500
u1 = runif(n)
x1 = rnorm(n)
Z1 = (u1 < 3/5) * (x1-1) + (u1> 3/5) * (x1+2)
f = function(x1){
         f = 3 * dnorm(x1,-1,1) / 5 + 2 * dnorm(x1,2,1) / 5
}

k = seq(from = -5, to = 6, by = 0.1)

sZ = sd(Z)
alpha = c(0.1,0.2,0.3,0.5,0.7,0.8)


par(mfrow = c(2,2))
n = c(50,100,500)


for(a in alpha){
  fenetre = sZ*n1**(-a)
  for (i in n){
  plot(k,f(k), type = "l", main= a, sub=i)
  PR= density(Z[1:i],kernel="gaussian", bw = fenetre )
  lines(PR, col = "cyan")
  legend("topright", ,legend=c("Densite","PR"),col=c("black","cyan"),lty=1)
  }
}
par(new = TRUE)

```



Partie 2 :

Tirer des conclusions sur les distributions